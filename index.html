<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChitraHarsha - Brilliant Joy in Every Transaction</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Exo+2:wght@700;800&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <meta
      name="description"
      content="ChitraHarsha (CHR) - A next-generation cryptocurrency platform leveraging AI, Quantum-ready speed, and supercomputer technology for secure, instant, and intelligent transactions."
    />
    <meta
      name="keywords"
      content="ChitraHarsha, CHR, Cryptocurrency, Blockchain, AI, Quantum Computing, BigQuery, Google Cloud, NLP, Web3, Decentralised Cryptocurrency, Crypto Wallet"
    />

    <style>
      :root {
        --primary-glow: rgba(59, 130, 246, 0.4);
        --secondary-glow: rgba(139, 92, 246, 0.4);
      }
      body {
        font-family: "Inter", sans-serif;
        background-color: #0d0f1a;
        color: #e0e0e0;
        overflow-x: hidden;
      }
      .font-exo {
        font-family: "Exo 2", sans-serif;
      }
      .aurora-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        background: radial-gradient(
            ellipse at 40% 20%,
            var(--primary-glow) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse at 60% 80%,
            var(--secondary-glow) 0%,
            transparent 50%
          );
        animation: aurora 15s linear infinite;
      }
      @keyframes aurora {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .glass-card {
        background: rgba(23, 26, 43, 0.6);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 1rem;
      }
      .gradient-text {
        background: linear-gradient(90deg, #818cf8, #a78bfa);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.8s ease-out, transform 0.8s ease-out;
      }
      .reveal.visible {
        opacity: 1;
        transform: translateY(0);
      }
      #lightning-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        opacity: 0.6;
      }
      #app-modal {
        transition: opacity 0.3s ease-in-out;
      }
      #app-modal-content {
        transition: transform 0.3s ease-in-out;
      }
    </style>
  </head>
  <body class="antialiased">
    <div class="aurora-background"></div>

    <!-- Main Landing Page Content -->
    <div id="landing-page">
      <header
        id="header"
        class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"
      >
        <nav
          class="container mx-auto px-6 py-4 flex justify-between items-center"
        >
          <a
            href="#home"
            class="flex items-center space-x-3"
            aria-label="ChitraHarsha Home"
          >
            <svg
              width="40"
              height="40"
              viewBox="0 0 256 256"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <path
                d="M128 24a104 104 0 1 0 104 104A104.11 104.11 0 0 0 128 24Zm0 192a88 88 0 1 1 88-88a88.1 88.1 0 0 1-88 88Z"
                fill="url(#paint0_linear_1_2)"
              />
              <path
                d="M168 88h-16v80h16a40 40 0 0 0 0-80Zm-8 64v-48a24 24 0 0 1 0 48Z"
                fill="url(#paint1_linear_1_2)"
              />
              <path
                d="M120 128a40 40 0 0 1-40-40h16a24 24 0 0 0 24 24Z"
                fill="url(#paint2_linear_1_2)"
              />
              <path
                d="M120 128a40 40 0 0 0-40 40h16a24 24 0 0 1 24-24Z"
                fill="url(#paint3_linear_1_2)"
              />
              <defs>
                <linearGradient
                  id="paint0_linear_1_2"
                  x1="128"
                  y1="24"
                  x2="128"
                  y2="232"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#A78BFA" />
                  <stop offset="1" stop-color="#3B82F6" />
                </linearGradient>
                <linearGradient
                  id="paint1_linear_1_2"
                  x1="152"
                  y1="88"
                  x2="152"
                  y2="168"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#C4B5FD" />
                  <stop offset="1" stop-color="#60A5FA" />
                </linearGradient>
                <linearGradient
                  id="paint2_linear_1_2"
                  x1="100"
                  y1="88"
                  x2="100"
                  y2="128"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#C4B5FD" />
                  <stop offset="1" stop-color="#60A5FA" />
                </linearGradient>
                <linearGradient
                  id="paint3_linear_1_2"
                  x1="100"
                  y1="128"
                  x2="100"
                  y2="168"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#C4B5FD" />
                  <stop offset="1" stop-color="#60A5FA" />
                </linearGradient>
              </defs>
            </svg>
            <span class="font-exo text-2xl font-bold text-white tracking-wider"
              >ChitraHarsha</span
            >
          </a>
          <div class="hidden md:flex items-center space-x-8">
            <a href="#home" class="text-gray-300 hover:text-white transition"
              >Home</a
            >
            <a
              href="#features"
              class="text-gray-300 hover:text-white transition"
              >Features</a
            >
            <a href="#stack" class="text-gray-300 hover:text-white transition"
              >Technology</a
            >
            <a href="#blogs" class="text-gray-300 hover:text-white transition"
              >Blogs</a
            >
            <a href="#contact" class="text-gray-300 hover:text-white transition"
              >Contact</a
            >
          </div>
          <div class="flex items-center space-x-4">
            <button
              id="launch-app-btn"
              class="px-4 py-2 text-sm font-semibold text-white bg-indigo-500 hover:bg-indigo-600 rounded-lg shadow-lg transition transform hover:scale-105"
            >
              Launch App
            </button>
          </div>
        </nav>
      </header>

      <main class="pt-20">
        <section
          id="home"
          class="relative min-h-screen flex items-center justify-center text-center overflow-hidden"
        >
          <canvas id="lightning-canvas"></canvas>
          <div class="relative z-10 container mx-auto px-6">
            <h1
              class="font-exo text-5xl md:text-7xl font-extrabold text-white leading-tight"
            >
              Chitra<span class="gradient-text">Harsha</span>
            </h1>
            <p class="mt-4 text-lg md:text-xl text-gray-300 max-w-3xl mx-auto">
              Brilliant Joy in Every Transaction. The world's first crypto
              platform powered by Quantum-ready architecture and
              Supercomputer-grade AI.
            </p>
            <div class="mt-8 flex justify-center gap-4">
              <button
                id="create-wallet-btn"
                class="px-8 py-3 font-semibold text-white bg-violet-600 hover:bg-violet-700 rounded-xl shadow-lg shadow-violet-500/30 transition transform hover:scale-105"
              >
                Create Your Wallet
              </button>
              <button
                class="px-8 py-3 font-semibold text-white bg-white/10 border border-white/20 hover:bg-white/20 rounded-xl transition"
              >
                Explore Whitepaper
              </button>
            </div>
            <p class="mt-4 text-xs text-gray-400">
              Secured with quantum-resistant encryption and passkey technology.
            </p>
          </div>
        </section>

        <section id="features" class="py-20">
          <div class="container mx-auto px-6">
            <div class="text-center mb-12 reveal">
              <h2 class="font-exo text-4xl font-bold text-white">
                The Future, Today.
              </h2>
              <p class="mt-2 text-gray-400">
                Discover the technologies that set ChitraHarsha apart.
              </p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
              <div class="glass-card p-6 text-center reveal">
                <h3 class="font-exo text-xl font-bold text-white">
                  Quantum & Supercomputer Core
                </h3>
                <p class="mt-2 text-gray-400 text-sm">
                  Our hybrid architecture processes transactions at near-instant
                  speeds, preparing for the quantum computing era.
                </p>
              </div>
              <div
                class="glass-card p-6 text-center reveal"
                style="transition-delay: 100ms"
              >
                <h3 class="font-exo text-xl font-bold text-white">
                  AI Crypto Lens
                </h3>
                <p class="mt-2 text-gray-400 text-sm">
                  Scan anything with your camera. Our AI identifies objects,
                  provides market data, and suggests CHR payment options.
                </p>
              </div>
              <div
                class="glass-card p-6 text-center reveal"
                style="transition-delay: 200ms"
              >
                <h3 class="font-exo text-xl font-bold text-white">
                  Quantum-Resistant Security
                </h3>
                <p class="mt-2 text-gray-400 text-sm">
                  With a quantum-resistant ledger and multi-layered data
                  encryption, your assets are fundamentally secure against
                  future threats.
                </p>
              </div>
              <div
                class="glass-card p-6 text-center reveal"
                style="transition-delay: 300ms"
              >
                <h3 class="font-exo text-xl font-bold text-white">
                  BigQuery Analytics
                </h3>
                <p class="mt-2 text-gray-400 text-sm">
                  Leveraging Google BigQuery for complex analytics, NLP-driven
                  insights, and predictive AI models.
                </p>
              </div>
            </div>
          </div>
        </section>

        <section id="stack" class="py-20 bg-black/20">
          <div class="container mx-auto px-6">
            <div class="text-center mb-12 reveal">
              <h2 class="font-exo text-4xl font-bold text-white">
                Our Future-Ready Technology Stack
              </h2>
              <p class="mt-2 text-gray-400">
                Built on a foundation of best-in-class, scalable, and secure
                technologies.
              </p>
            </div>
            <div
              class="max-w-4xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-8 text-center"
            >
              <div class="reveal">
                <img
                  src="https://placehold.co/120x120/1f2937/a78bfa?text=CF"
                  alt="Cloudflare logo placeholder"
                  class="mx-auto rounded-full w-24 h-24 border-2 border-violet-500 p-1"
                />
                <h3 class="mt-4 font-bold text-white">Cloudflare Pages</h3>
                <p class="text-sm text-gray-400 mt-1">
                  Global, low-latency deployment for instant web app access.
                </p>
              </div>
              <div class="reveal" style="transition-delay: 100ms">
                <img
                  src="https://placehold.co/120x120/1f2937/818cf8?text=FS"
                  alt="Firestore logo placeholder"
                  class="mx-auto rounded-full w-24 h-24 border-2 border-indigo-500 p-1"
                />
                <h3 class="mt-4 font-bold text-white">Google Firestore</h3>
                <p class="text-sm text-gray-400 mt-1">
                  Real-time, encrypted database for user data and fast
                  operations.
                </p>
              </div>
              <div class="reveal" style="transition-delay: 200ms">
                <img
                  src="https://placehold.co/120x120/1f2937/60a5fa?text=BQ"
                  alt="BigQuery logo placeholder"
                  class="mx-auto rounded-full w-24 h-24 border-2 border-blue-500 p-1"
                />
                <h3 class="mt-4 font-bold text-white">Google BigQuery</h3>
                <p class="text-sm text-gray-400 mt-1">
                  Planet-scale data warehouse for complex SQL queries and AI/ML
                  models.
                </p>
              </div>
              <div class="reveal" style="transition-delay: 300ms">
                <img
                  src="https://placehold.co/120x120/1f2937/f472b6?text=AI"
                  alt="Gemini AI logo placeholder"
                  class="mx-auto rounded-full w-24 h-24 border-2 border-pink-500 p-1"
                />
                <h3 class="mt-4 font-bold text-white">Gemini & Vision AI</h3>
                <p class="mt-sm text-gray-400 mt-1">
                  Advanced AI models for the Crypto Lens, chatbot, and NLP
                  tasks.
                </p>
              </div>
            </div>
          </div>
        </section>

        <section id="blogs" class="py-20">
          <div class="container mx-auto px-6">
            <div class="text-center mb-12 reveal">
              <h2 class="font-exo text-4xl font-bold text-white">
                Insights from the New Economy
              </h2>
              <p class="mt-2 text-gray-400">
                Read our latest articles on DeFi, AI in Blockchain, and the
                future of finance.
              </p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              <div class="glass-card overflow-hidden reveal">
                <img
                  src="https://placehold.co/600x400/111827/a78bfa?text=DeFi+2.0"
                  alt="DeFi 2.0 placeholder image"
                  class="w-full h-48 object-cover"
                />
                <div class="p-6">
                  <h3 class="font-exo text-xl font-bold text-white">
                    The Quantum Leap: Preparing for the Future
                  </h3>
                  <p class="mt-3 text-gray-400 text-sm">
                    Quantum computers pose a threat to current encryption
                    standards. Discover how ChitraHarsha's quantum-resistant
                    ledger is built for long-term security.
                  </p>
                  <a
                    href="#"
                    class="inline-block mt-4 font-semibold text-indigo-400 hover:text-indigo-300"
                    >Read More &rarr;</a
                  >
                </div>
              </div>
              <div
                class="glass-card overflow-hidden reveal"
                style="transition-delay: 150ms"
              >
                <img
                  src="https://placehold.co/600x400/111827/818cf8?text=AI+in+Crypto"
                  alt="AI in Crypto placeholder image"
                  class="w-full h-48 object-cover"
                />
                <div class="p-6">
                  <h3 class="font-exo text-xl font-bold text-white">
                    From Data to Decisions with BigQuery ML
                  </h3>
                  <p class="mt-3 text-gray-400 text-sm">
                    Learn how we use Google BigQuery's built-in AI to run
                    predictive models for fraud detection and market analysis
                    directly on our blockchain data.
                  </p>
                  <a
                    href="#"
                    class="inline-block mt-4 font-semibold text-indigo-400 hover:text-indigo-300"
                    >Read More &rarr;</a
                  >
                </div>
              </div>
              <div
                class="glass-card overflow-hidden reveal"
                style="transition-delay: 300ms"
              >
                <img
                  src="https://placehold.co/600x400/111827/ffffff?text=Web3+Security"
                  alt="Web3 Security placeholder image"
                  class="w-full h-48 object-cover"
                />
                <div class="p-6">
                  <h3 class="font-exo text-xl font-bold text-white">
                    What Are Passkeys? A Simpler, More Secure Future
                  </h3>
                  <p class="mt-3 text-gray-400 text-sm">
                    Passwords are a thing of the past. We break down how Passkey
                    technology works and why it's the new gold standard for
                    securing your ChitraHarsha assets.
                  </p>
                  <a
                    href="#"
                    class="inline-block mt-4 font-semibold text-indigo-400 hover:text-indigo-300"
                    >Read More &rarr;</a
                  >
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="contact" class="py-20 bg-black/20">
          <div class="container mx-auto px-6 reveal">
            <div class="max-w-2xl mx-auto text-center">
              <h2 class="font-exo text-4xl font-bold text-white">
                Get In Touch
              </h2>
              <p class="mt-2 text-gray-400 mb-8">
                This project is a Proof of Concept. To test the AI and Database
                features, launch the app. For questions or partnerships, please
                reach out on our official channels.
              </p>
              <!-- A form is removed to prevent phishing warnings from browsers on new domains. -->
            </div>
          </div>
        </section>
      </main>

      <footer class="bg-gray-900/50 border-t border-white/10">
        <div class="container mx-auto px-6 py-8">
          <div
            class="flex flex-col md:flex-row justify-between items-center text-center md:text-left space-y-6 md:space-y-0"
          >
            <div>
              <div
                class="flex items-center justify-center md:justify-start space-x-3"
              >
                <svg
                  width="32"
                  height="32"
                  viewBox="0 0 256 256"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <path
                    d="M128 24a104 104 0 1 0 104 104A104.11 104.11 0 0 0 128 24Zm0 192a88 88 0 1 1 88-88a88.1 88.1 0 0 1-88 88Z"
                    fill="url(#paint0_linear_footer)"
                  />
                  <path
                    d="M168 88h-16v80h16a40 40 0 0 0 0-80Zm-8 64v-48a24 24 0 0 1 0 48Z"
                    fill="url(#paint1_linear_footer)"
                  />
                  <path
                    d="M120 128a40 40 0 0 1-40-40h16a24 24 0 0 0 24 24Z"
                    fill="url(#paint2_linear_footer)"
                  />
                  <path
                    d="M120 128a40 40 0 0 0-40 40h16a24 24 0 0 1 24-24Z"
                    fill="url(#paint3_linear_footer)"
                  />
                  <defs>
                    <linearGradient
                      id="paint0_linear_footer"
                      x1="128"
                      y1="24"
                      x2="128"
                      y2="232"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop stop-color="#A78BFA" />
                      <stop offset="1" stop-color="#3B82F6" />
                    </linearGradient>
                    <linearGradient
                      id="paint1_linear_footer"
                      x1="152"
                      y1="88"
                      x2="152"
                      y2="168"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop stop-color="#C4B5FD" />
                      <stop offset="1" stop-color="#60A5FA" />
                    </linearGradient>
                    <linearGradient
                      id="paint2_linear_footer"
                      x1="100"
                      y1="88"
                      x2="100"
                      y2="128"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop stop-color="#C4B5FD" />
                      <stop offset="1" stop-color="#60A5FA" />
                    </linearGradient>
                    <linearGradient
                      id="paint3_linear_footer"
                      x1="100"
                      y1="128"
                      x2="100"
                      y2="168"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop stop-color="#C4B5FD" />
                      <stop offset="1" stop-color="#60A5FA" />
                    </linearGradient>
                  </defs></svg
                ><span
                  class="font-exo text-xl font-bold text-white tracking-wider"
                  >ChitraHarsha</span
                >
              </div>
              <p class="mt-2 text-sm text-gray-400">
                &copy; 2025 ChitraHarsha. All Rights Reserved.
              </p>
            </div>
            <div class="flex space-x-6">
              <a href="#" class="text-gray-400 hover:text-white transition"
                >Privacy Policy</a
              ><a href="#" class="text-gray-400 hover:text-white transition"
                >Terms of Service</a
              ><a
                href="#contact"
                class="text-gray-400 hover:text-white transition"
                >Contact</a
              >
            </div>
          </div>
          <div
            class="mt-8 pt-6 border-t border-white/10 text-center text-xs text-gray-500"
          >
            <p class="font-semibold text-amber-400">Important Disclaimer:</p>
            <p>
              This website is a technology demonstration and not a real
              financial product. Cryptocurrency investments are subject to high
              market risk. Please conduct your own research. ChitraHarsha is not
              responsible for any losses. All data is for illustrative purposes
              only.
            </p>
          </div>
        </div>
      </footer>
    </div>

    <!-- App Modal -->
    <div
      id="app-modal"
      class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 opacity-0 pointer-events-none"
    >
      <div
        id="app-modal-content"
        class="glass-card w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col transform scale-95"
      >
        <div
          class="flex items-center justify-between p-4 border-b border-white/10 flex-shrink-0"
        >
          <div class="flex items-center space-x-3">
            <svg
              width="32"
              height="32"
              viewBox="0 0 256 256"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <use href="#paint0_linear_1_2"></use>
              <use href="#paint1_linear_1_2"></use>
              <use href="#paint2_linear_1_2"></use>
              <use href="#paint3_linear_1_2"></use></svg
            ><span class="font-exo text-xl font-bold text-white"
              >ChitraHarsha App</span
            >
          </div>
          <button
            id="close-modal-btn"
            class="p-2 rounded-full text-gray-400 hover:bg-white/10 hover:text-white transition"
            aria-label="Close App"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <div class="flex-grow p-6 overflow-y-auto">
          <div id="wallet-section">
            <h2 class="text-2xl font-bold font-exo text-white">My Wallet</h2>
            <div id="wallet-loading" class="mt-4 text-center text-gray-400">
              Connecting to secure server...
            </div>
            <div
              id="wallet-details"
              class="hidden mt-4 glass-card p-4 space-y-3"
            >
              <div>
                <div class="flex justify-between items-center">
                  <p class="text-sm text-gray-400">Wallet Address</p>
                  <button
                    id="copy-address-btn"
                    class="text-xs text-indigo-400 hover:text-indigo-300 font-semibold"
                  >
                    COPY
                  </button>
                </div>
                <p
                  id="wallet-address"
                  class="font-mono text-sm text-indigo-300 break-all"
                ></p>
              </div>
              <div>
                <p class="text-sm text-gray-400">Balance</p>
                <p
                  id="wallet-balance"
                  class="text-2xl font-bold text-white"
                ></p>
              </div>
              <p class="text-xs text-gray-500 pt-2 border-t border-white/10">
                This is a simulated wallet for demonstration purposes. Do not
                send real assets to this address.
              </p>
            </div>
          </div>

          <div id="ai-section" class="mt-8">
            <h2 class="text-2xl font-bold font-exo text-white">
              AI Assistant (Powered by Gemini)
            </h2>
            <p class="text-sm text-gray-400 mb-4">
              Ask me anything about ChitraHarsha, blockchain, or the market.
            </p>
            <div
              id="chat-history"
              class="h-64 overflow-y-auto p-4 glass-card space-y-4 mb-4 flex flex-col"
            ></div>
            <form id="ai-form" class="flex items-center gap-4">
              <input
                id="ai-prompt"
                type="text"
                placeholder="Type your question..."
                required
                class="flex-grow bg-gray-800/50 border border-white/20 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"
                autocomplete="off"
              />
              <button
                type="submit"
                id="ai-submit-btn"
                class="px-6 py-3 font-semibold text-white bg-indigo-500 hover:bg-indigo-600 rounded-lg shadow-lg transition"
              >
                Send
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getAuth,
        signInAnonymously,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
      import {
        getFirestore,
        doc,
        getDoc,
        setDoc,
        collection,
        addDoc,
        onSnapshot,
        query,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

      const firebaseConfig = JSON.parse(
        typeof __firebase_config !== "undefined" ? __firebase_config : "{}"
      );
      const appId =
        typeof __app_id !== "undefined" ? __app_id : "chitraharsha-demo";
      const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=`;

      let app, auth, db, userId, unsubscribeWallet, unsubscribeMessages;
      try {
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        db = getFirestore(app);
      } catch (e) {
        console.error("Firebase initialization failed. Using mock data.", e);
        document.getElementById("wallet-loading").textContent =
          "Connection failed. Please refresh.";
      }

      const appModal = document.getElementById("app-modal");
      const appModalContent = document.getElementById("app-modal-content");
      const launchAppBtn = document.getElementById("launch-app-btn");
      const createWalletBtn = document.getElementById("create-wallet-btn");
      const closeModalBtn = document.getElementById("close-modal-btn");
      const walletLoading = document.getElementById("wallet-loading");
      const walletDetails = document.getElementById("wallet-details");
      const walletAddressEl = document.getElementById("wallet-address");
      const walletBalanceEl = document.getElementById("wallet-balance");
      const copyAddressBtn = document.getElementById("copy-address-btn");
      const aiForm = document.getElementById("ai-form");
      const aiPromptInput = document.getElementById("ai-prompt");
      const aiSubmitBtn = document.getElementById("ai-submit-btn");
      const chatHistoryEl = document.getElementById("chat-history");

      function openApp() {
        appModal.classList.remove("opacity-0", "pointer-events-none");
        appModalContent.classList.remove("scale-95");
      }
      function closeApp() {
        appModal.classList.add("opacity-0", "pointer-events-none");
        appModalContent.classList.add("scale-95");
      }

      async function createOrGetWallet() {
        if (!userId) return;
        const walletRef = doc(
          db,
          `artifacts/${appId}/users/${userId}/wallet/main`
        );
        let walletDoc = await getDoc(walletRef);
        if (!walletDoc.exists()) {
          await setDoc(walletRef, {
            address: `CHR-${crypto.randomUUID()}`,
            balance: 1000.0,
            createdAt: new Date(),
          });
        }
        setupWalletListener();
      }

      function setupWalletListener() {
        if (!userId) return;
        const walletRef = doc(
          db,
          `artifacts/${appId}/users/${userId}/wallet/main`
        );
        unsubscribeWallet = onSnapshot(walletRef, (doc) => {
          if (doc.exists()) {
            const data = doc.data();
            walletAddressEl.textContent = data.address;
            walletBalanceEl.textContent = `${data.balance.toFixed(2)} CHR`;
            walletLoading.classList.add("hidden");
            walletDetails.classList.remove("hidden");
          }
        });
      }

      function setupMessagesListener() {
        if (!userId) return;
        const messagesRef = collection(
          db,
          `artifacts/${appId}/users/${userId}/messages`
        );
        const q = query(messagesRef);
        unsubscribeMessages = onSnapshot(q, (snapshot) => {
          const messages = snapshot.docs
            .map((doc) => doc.data())
            .sort((a, b) => a.timestamp - b.timestamp);
          renderMessages(messages);
        });
      }

      function renderMessages(messages) {
        chatHistoryEl.innerHTML =
          messages.length === 0
            ? `<p class="text-center text-gray-500 text-sm">No messages yet. Ask the AI something!</p>`
            : "";
        if (messages.length > 0) {
          messages.forEach((msg) => {
            const el = document.createElement("div");
            el.classList.add("p-3", "rounded-lg", "max-w-[80%]", "w-fit");
            el.classList.toggle("bg-indigo-600", msg.role === "user");
            el.classList.toggle("text-white", msg.role === "user");
            el.classList.toggle("ml-auto", msg.role === "user");
            el.classList.toggle("bg-gray-700", msg.role !== "user");
            el.classList.toggle("text-gray-200", msg.role !== "user");
            el.textContent = msg.text;
            chatHistoryEl.appendChild(el);
          });
        }
        chatHistoryEl.scrollTop = chatHistoryEl.scrollHeight;
      }

      async function handleAiSubmit(e) {
        e.preventDefault();
        const prompt = aiPromptInput.value.trim();
        if (!prompt || !userId) return;

        aiPromptInput.value = "";
        aiSubmitBtn.disabled = true;
        aiSubmitBtn.textContent = "...";

        const messagesRef = collection(
          db,
          `artifacts/${appId}/users/${userId}/messages`
        );
        await addDoc(messagesRef, {
          role: "user",
          text: prompt,
          timestamp: Date.now(),
        });

        try {
          const response = await fetch(GEMINI_API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [
                {
                  parts: [
                    {
                      text: `You are the ChitraHarsha AI Assistant. Be helpful and concise. User question: "${prompt}"`,
                    },
                  ],
                },
              ],
            }),
          });
          if (!response.ok)
            throw new Error(`API Error: ${response.statusText}`);
          const result = await response.json();
          const aiText =
            result.candidates?.[0]?.content?.parts?.[0]?.text ||
            "Sorry, I couldn't process that.";
          await addDoc(messagesRef, {
            role: "model",
            text: aiText,
            timestamp: Date.now(),
          });
        } catch (error) {
          console.error("Error calling Gemini API:", error);
          await addDoc(messagesRef, {
            role: "model",
            text: "An error occurred. Please try again.",
            timestamp: Date.now(),
          });
        } finally {
          aiSubmitBtn.disabled = false;
          aiSubmitBtn.textContent = "Send";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const header = document.getElementById("header");
        window.addEventListener("scroll", () => {
          header.classList.toggle("bg-gray-900/80", window.scrollY > 50);
          header.classList.toggle("backdrop-blur-sm", window.scrollY > 50);
        });

        const revealElements = document.querySelectorAll(".reveal");
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) =>
              entry.target.classList.toggle("visible", entry.isIntersecting)
            );
          },
          { threshold: 0.1 }
        );
        revealElements.forEach((el) => observer.observe(el));

        // --- Lightning Animation Code (Restored) ---
        const canvas = document.getElementById("lightning-canvas");
        const ctx = canvas.getContext("2d");
        let w,
          h,
          lightning = [];

        function initCanvas() {
          w = canvas.width = window.innerWidth;
          h = canvas.height = document.getElementById("home").offsetHeight;
          lightning = [];
        }
        initCanvas();
        window.addEventListener("resize", initCanvas);

        class Lightning {
          constructor() {
            this.x = Math.random() * w;
            this.y = (Math.random() * h) / 4;
            this.path = [{ x: this.x, y: this.y }];
            this.life = 0;
            this.maxLife = Math.random() * 20 + 10;
            this.color = `rgba(167, 139, 250, ${Math.random() * 0.4 + 0.2})`;
          }
          draw() {
            ctx.beginPath();
            ctx.moveTo(this.path[0].x, this.path[0].y);
            for (let i = 1; i < this.path.length; i++) {
              ctx.lineTo(this.path[i].x, this.path[i].y);
            }
            ctx.strokeStyle = this.color;
            ctx.lineWidth = Math.random() * 2 + 1;
            ctx.stroke();
            this.update();
          }
          update() {
            this.life++;
            if (this.life < this.maxLife) {
              const lastPoint = this.path[this.path.length - 1];
              this.path.push({
                x: lastPoint.x + (Math.random() * 20 - 10),
                y: lastPoint.y + (Math.random() * 15 + 5),
              });
            }
          }
        }

        function animateLightning() {
          ctx.clearRect(0, 0, w, h);
          if (Math.random() < 0.05) lightning.push(new Lightning());
          lightning.forEach((l, index) => {
            l.draw();
            if (l.life >= l.maxLife) lightning.splice(index, 1);
          });
          requestAnimationFrame(animateLightning);
        }
        animateLightning();
      });

      launchAppBtn.addEventListener("click", openApp);
      createWalletBtn.addEventListener("click", openApp);
      closeModalBtn.addEventListener("click", closeApp);
      aiForm.addEventListener("submit", handleAiSubmit);
      copyAddressBtn.addEventListener("click", () => {
        navigator.clipboard.writeText(walletAddressEl.textContent).then(() => {
          copyAddressBtn.textContent = "COPIED!";
          setTimeout(() => {
            copyAddressBtn.textContent = "COPY";
          }, 2000);
        });
      });

      onAuthStateChanged(auth, async (user) => {
        if (user) {
          userId = user.uid;
          await createOrGetWallet();
          setupMessagesListener();
        } else {
          userId = null;
          if (unsubscribeWallet) unsubscribeWallet();
          if (unsubscribeMessages) unsubscribeMessages();
          try {
            await signInAnonymously(auth);
          } catch (e) {
            console.error("Anonymous sign-in failed:", e);
          }
        }
      });
    </script>
  </body>
</html>
